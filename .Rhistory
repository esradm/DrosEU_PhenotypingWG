source("meta_analysis_functions.R")
Via_fitted <- combineFitted(labs = c("Gibert", "Grath", "Hoedjes", "Schmidt", "StamenkovicRadak", "Zwaan"), sex = rep("NA", 6), models = list(Via_lmer_Gibert, Via_lmer_Grath, Via_lmer_Hoedjes, Via_lm_Schmidt, Via_lmer_StamenkovicRadak, Via_lmer_Zwaan))
Via_fitted
Via_lm_Schmidt <- lm(ProportionEggtoAdultSurvival ~ -1 + Population, data = d_Via[d_Via$Supervisor.PI == "Schmidt",])
capture.output(summary(Via_lm_Schmidt),file = "Viability/Via_lm_Schmidt_sum.txt")
capture.output(anova(Via_lm_Schmidt),file = "Viability/Via_lm_Schmidt.txt")
capture.output(emmeans(Via_lm_Schmidt, list(pairwise ~ Population), adjust = "tukey"),file = "Viability/Via_lm_Schmidt_tk.txt")
Via_fitted <- combineFitted(labs = c("Gibert", "Grath", "Hoedjes", "Schmidt", "StamenkovicRadak", "Zwaan"), sex = rep("NA", 6), models = list(Via_lmer_Gibert, Via_lmer_Grath, Via_lmer_Hoedjes, Via_lm_Schmidt, Via_lmer_StamenkovicRadak, Via_lmer_Zwaan))
scatterPlotMatrix(Via_fitted, sex = "NA")
scatterPlotMatrix(Via_fitted, sex = "NA")
p_Via_lab_cor <- scatterPlotMatrix(Via_fitted, sex = "NA")
Via_fitted <- combineFitted(labs = c("Gibert", "Grath", "Hoedjes", "Schmidt", "StamenkovicRadak", "Zwaan"), sex = rep("NA", 6), models = list(Via_lmer_Gibert, Via_lmer_Grath, Via_lmer_Hoedjes, Via_lm_Schmidt, Via_lmer_StamenkovicRadak, Via_lmer_Zwaan))
p_Via_lab_cor <- scatterPlotMatrix(Via_fitted, sex = "NA")
p_Via_lab_cor <- scatterPlotMatrix(Via_fitted, sex = "NA")
pdf(file="Viability/p_Via_lab_cor.pdf",width=8, height=8)
p_Via_lab_cor
invisible(dev.off())
p_Via_lab_cor <- function() scatterPlotMatrix(Via_fitted, sex = "NA")
Via_fitted <- combineFitted(labs = c("Gibert", "Grath", "Hoedjes", "Schmidt", "StamenkovicRadak", "Zwaan"), sex = rep("NA", 6), models = list(Via_lmer_Gibert, Via_lmer_Grath, Via_lmer_Hoedjes, Via_lm_Schmidt, Via_lmer_StamenkovicRadak, Via_lmer_Zwaan))
Via_fitted <- combineFitted(labs = c("Gibert", "Grath", "Hoedjes", "Schmidt", "StamenkovicRadak", "Zwaan"), sex = rep("NA", 6), models = list(Via_lmer_Gibert, Via_lmer_Grath, Via_lmer_Hoedjes, Via_lm_Schmidt, Via_lmer_StamenkovicRadak, Via_lmer_Zwaan))
p_Via_lab_cor <- function() scatterPlotMatrix(Via_fitted, sex = "NA")
p_Via_lab_cor
p_Via_lab_cor()
pdf(file="Viability/p_Via_lab_cor.pdf",width=8, height=8)
p_Via_lab_cor()
invisible(dev.off())
DT_A_F_lmer_Gibert <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_F[d_DT_A_F$Supervisor.PI == "Gibert",])
min_DT_A <- min(d_DT_A$DT_EggAdult)
d_DT_A <- read.csv("MasterSheets_Oct21_git/DTA_MasterSheet_Oct21.csv")
str(d_DT_A) #Factors need reformatting
d_DT_A$Supervisor.PI <- as.factor(d_DT_A$Supervisor.PI)
d_DT_A$Diet <- as.factor(d_DT_A$Diet)
d_DT_A$Batch <- as.factor(d_DT_A$Batch)
d_DT_A$Population_Lat <- factor(d_DT_A$Population, levels= c("YE","RE","GI","MU","MA","UM","KA","VA","AK"))
d_DT_A$Population_Lon <- factor(d_DT_A$Population, levels= c("RE","GI","KA","MU","MA","AK","UM","YE","VA"))
d_DT_A$Population_Alt <- factor(d_DT_A$Population, levels= c("KA","AK","GI","RE","UM","VA","MU","MA","YE"))
d_DT_A$Line <- as.factor(d_DT_A$Line)
d_DT_A$Sex <- as.factor(d_DT_A$Sex)
d_DT_A$ReplicateVial <- as.factor(d_DT_A$ReplicateVial)
d_DT_A$DT_EggAdult <- as.numeric(d_DT_A$DT_EggAdult)
str(d_DT_A) #They should be ok now.
#Create data sheets for females (d_DT_A_F) and males (d_DT_A_M), by sorting at sex level.
d_DT_A_F <-subset(d_DT_A,Sex=='F')
d_DT_A_M <-subset(d_DT_A,Sex=='M')
DT_A_F_lmer_Gibert <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_F[d_DT_A_F$Supervisor.PI == "Gibert",])
capture.output(summary(DT_A_F_lmer_Gibert),file = "DevelopmentTime/DT_A_F_lmer_Gibert_sum.txt")
capture.output(anova(DT_A_F_lmer_Gibert),file = "DevelopmentTime/DT_A_F_lmer_Gibert.txt")
capture.output(emmeans(DT_A_F_lmer_Gibert, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_F_lmer_Gibert_tk.txt")
DT_A_F_lmer_Grath <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|ReplicateVial : Line), data = d_DT_A_F[d_DT_A_F$Supervisor.PI == "Grath",])
capture.output(summary(DT_A_F_lmer_Grath),file = "DevelopmentTime/DT_A_F_lmer_Grath_sum.txt")
capture.output(anova(DT_A_F_lmer_Grath),file = "DevelopmentTime/DT_A_F_lmer_Grath.txt")
capture.output(emmeans(DT_A_F_lmer_Grath, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_F_lmer_Grath_tk.txt")
DT_A_F_lmer_Hoedjes <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_F[d_DT_A_F$Supervisor.PI == "Hoedjes",])
capture.output(summary(DT_A_F_lmer_Hoedjes),file = "DevelopmentTime/DT_A_F_lmer_Hoedjes_sum.txt")
capture.output(anova(DT_A_F_lmer_Hoedjes),file = "DevelopmentTime/DT_A_F_lmer_Hoedjes.txt")
capture.output(emmeans(DT_A_F_lmer_Hoedjes, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_F_lmer_Hoedjes_tk.txt")
DT_A_F_lmer_Schmidt <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population), data = d_DT_A_F[d_DT_A_F$Supervisor.PI == "Schmidt",])
capture.output(summary(DT_A_F_lmer_Schmidt),file = "DevelopmentTime/DT_A_F_lmer_Schmidt_sum.txt")
capture.output(anova(DT_A_F_lmer_Schmidt),file = "DevelopmentTime/DT_A_F_lmer_Schmidt.txt")
capture.output(emmeans(DT_A_F_lmer_Schmidt, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_F_lmer_Schmidt_tk.txt")
DT_A_F_lmer_StamenkovicRadak <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population)+ (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_F[d_DT_A_F$Supervisor.PI == "StamenkovicRadak",])
capture.output(summary(DT_A_F_lmer_StamenkovicRadak),file = "DevelopmentTime/DT_A_F_lmer_StamenkovicRadak_sum.txt")
capture.output(anova(DT_A_F_lmer_StamenkovicRadak),file = "DevelopmentTime/DT_A_F_lmer_StamenkovicRadak.txt")
capture.output(emmeans(DT_A_F_lmer_StamenkovicRadak, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_F_lmer_StamenkovicRadak_tk.txt")
DT_A_F_lmer_Zwaan <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_F[d_DT_A_F$Supervisor.PI == "Zwaan",])
capture.output(summary(DT_A_F_lmer_Zwaan),file = "DevelopmentTime/DT_A_F_lmer_Zwaan_sum.txt")
capture.output(anova(DT_A_F_lmer_Zwaan),file = "DevelopmentTime/DT_A_F_lmer_Zwaan.txt")
capture.output(emmeans(DT_A_F_lmer_Zwaan, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_F_lmer_Zwaan_tk.txt")
DT_A_fitted <- combineFitted(labs = rep(c("Gibert", "Grath", "Hoedjes", "Schmidt", "StamenkovicRadak", "Zwaan"), 2), sex = rep(c("F", "M"), each = 6), models = list(DT_A_F_lmer_Gibert, DT_A_F_lmer_Grath, DT_A_F_lmer_Hoedjes, DT_A_F_lmer_Schmidt, DT_A_F_lmer_StamenkovicRadak, DT_A_F_lmer_Zwaan, DT_A_M_lmer_Gibert, DT_A_M_lmer_Grath, DT_A_M_lmer_Hoedjes, DT_A_M_lmer_Schmidt, DT_A_M_lmer_StamenkovicRadak, DT_A_M_lmer_Zwaan))
DT_A_M_lmer_Gibert <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_M[d_DT_A_M$Supervisor.PI == "Gibert",])
capture.output(summary(DT_A_M_lmer_Gibert),file = "DevelopmentTime/DT_A_M_lmer_Gibert_sum.txt")
capture.output(anova(DT_A_M_lmer_Gibert),file = "DevelopmentTime/DT_A_M_lmer_Gibert.txt")
capture.output(emmeans(DT_A_M_lmer_Gibert, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_M_lmer_Gibert_tk.txt")
DT_A_M_lmer_Grath <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|ReplicateVial : Line), data = d_DT_A_M[d_DT_A_M$Supervisor.PI == "Grath",])
capture.output(summary(DT_A_M_lmer_Grath),file = "DevelopmentTime/DT_A_M_lmer_Grath_sum.txt")
capture.output(anova(DT_A_M_lmer_Grath),file = "DevelopmentTime/DT_A_M_lmer_Grath.txt")
capture.output(emmeans(DT_A_M_lmer_Grath, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_M_lmer_Grath_tk.txt")
DT_A_M_lmer_Hoedjes <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_M[d_DT_A_M$Supervisor.PI == "Hoedjes",])
capture.output(summary(DT_A_M_lmer_Hoedjes),file = "DevelopmentTime/DT_A_M_lmer_Hoedjes_sum.txt")
capture.output(anova(DT_A_M_lmer_Hoedjes),file = "DevelopmentTime/DT_A_M_lmer_Hoedjes.txt")
capture.output(emmeans(DT_A_M_lmer_Hoedjes, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_M_lmer_Hoedjes_tk.txt")
DT_A_M_lmer_Schmidt <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population), data = d_DT_A_M[d_DT_A_M$Supervisor.PI == "Schmidt",])
capture.output(summary(DT_A_M_lmer_Schmidt),file = "DevelopmentTime/DT_A_M_lmer_Schmidt_sum.txt")
capture.output(anova(DT_A_M_lmer_Schmidt),file = "DevelopmentTime/DT_A_M_lmer_Schmidt.txt")
capture.output(emmeans(DT_A_M_lmer_Schmidt, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_M_lmer_Schmidt_tk.txt")
DT_A_M_lmer_StamenkovicRadak <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_M[d_DT_A_M$Supervisor.PI == "StamenkovicRadak",])
capture.output(summary(DT_A_M_lmer_StamenkovicRadak),file = "DevelopmentTime/DT_A_M_lmer_StamenkovicRadak_sum.txt")
capture.output(anova(DT_A_M_lmer_StamenkovicRadak),file = "DevelopmentTime/DT_A_M_lmer_StamenkovicRadak.txt")
capture.output(emmeans(DT_A_M_lmer_StamenkovicRadak, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_M_lmer_StamenkovicRadak_tk.txt")
DT_A_fitted <- combineFitted(labs = rep(c("Gibert", "Grath", "Hoedjes", "Schmidt", "StamenkovicRadak", "Zwaan"), 2), sex = rep(c("F", "M"), each = 6), models = list(DT_A_F_lmer_Gibert, DT_A_F_lmer_Grath, DT_A_F_lmer_Hoedjes, DT_A_F_lmer_Schmidt, DT_A_F_lmer_StamenkovicRadak, DT_A_F_lmer_Zwaan, DT_A_M_lmer_Gibert, DT_A_M_lmer_Grath, DT_A_M_lmer_Hoedjes, DT_A_M_lmer_Schmidt, DT_A_M_lmer_StamenkovicRadak, DT_A_M_lmer_Zwaan))
DT_A_M_lmer_Zwaan <- lmer(DT_EggAdult ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial : Line), data = d_DT_A_M[d_DT_A_M$Supervisor.PI == "Zwaan",])
capture.output(summary(DT_A_M_lmer_Zwaan),file = "DevelopmentTime/DT_A_M_lmer_Zwaan_sum.txt")
capture.output(anova(DT_A_M_lmer_Zwaan),file = "DevelopmentTime/DT_A_M_lmer_Zwaan.txt")
capture.output(emmeans(DT_A_M_lmer_Zwaan, list(pairwise ~ Population), adjust = "tukey"),file = "DevelopmentTime/DT_A_M_lmer_Zwaan_tk.txt")
DT_A_fitted <- combineFitted(labs = rep(c("Gibert", "Grath", "Hoedjes", "Schmidt", "StamenkovicRadak", "Zwaan"), 2), sex = rep(c("F", "M"), each = 6), models = list(DT_A_F_lmer_Gibert, DT_A_F_lmer_Grath, DT_A_F_lmer_Hoedjes, DT_A_F_lmer_Schmidt, DT_A_F_lmer_StamenkovicRadak, DT_A_F_lmer_Zwaan, DT_A_M_lmer_Gibert, DT_A_M_lmer_Grath, DT_A_M_lmer_Hoedjes, DT_A_M_lmer_Schmidt, DT_A_M_lmer_StamenkovicRadak, DT_A_M_lmer_Zwaan))
p_DT_A_F_lab_cor <- function() scatterPlotMatrix(DT_A_fitted, sex = "F")
p_DT_A_M_lab_cor <- function() scatterPlotMatrix(DT_A_fitted, sex = "M")
p_DT_A_F_lab_cor()
pdf(file="DevelopmentTime/p_DT_A_F_lab_cor.pdf",width=8, height=8)
p_DT_A_F_lab_cor()
invisible(dev.off())
p_DT_A_M_lab_cor()
pdf(file="DevelopmentTime/p_DT_A_M_lab_cor.pdf",width=8, height=8)
p_DT_A_M_lab_cor()
invisible(dev.off())
DT_A_fitted
d_DW <- read.csv("MasterSheets_Oct21_git/DW_MasterSheet_Oct21.csv")
str(d_DW)
d_DW$Supervisor.PI <- as.factor(d_DW$Supervisor.PI)
d_DW$Diet <- as.factor(d_DW$Diet)
d_DW$Batch <- as.factor(d_DW$Batch)
d_DW$Population <- as.factor(d_DW$Population)
d_DW$Population_Lat <- factor(d_DW$Population, levels= c("YE","RE","GI","MU","MA","UM","KA","VA","AK"))
d_DW$Population_Lon <- factor(d_DW$Population, levels= c("RE","GI","KA","MU","MA","AK","UM","YE","VA"))
d_DW$Population_Alt <- factor(d_DW$Population, levels= c("KA","AK","GI","RE","UM","VA","MU","MA","YE"))
d_DW$Line <- as.factor(d_DW$Line)
d_DW$Sex <- as.factor(d_DW$Sex)
d_DW$DW_micrograms <- as.numeric(d_DW$DW_micrograms)
str(d_DW)
d_DW_F <-subset(d_DW,Sex=='F')
d_DW_M <-subset(d_DW,Sex=='M')
DW_F_lmer_Colinet <- lmer(DW_micrograms ~ -1 + Population + (1|Population:Line) + (1|Batch), data = d_DW_F[d_DW_F$Supervisor.PI == "Colinet",])
capture.output(summary(DW_F_lmer_Colinet),file = "DryWeight/DW_F_lmer_Colinet_sum.txt")
capture.output(anova(DW_F_lmer_Colinet),file = "DryWeight/DW_F_lmer_Colinet.txt")
capture.output(emmeans(DW_F_lmer_Colinet, list(pairwise ~ Population), adjust = "tukey"),file = "DryWeight/DW_F_lmer_Colinet_tk.txt")
DW_M_lmer_Colinet <- lmer(DW_micrograms ~ -1 + Population + (1|Population:Line) + (1|Batch), data = d_DW_M[d_DW_M$Supervisor.PI == "Colinet",])
capture.output(summary(DW_M_lmer_Colinet),file = "DryWeight/DW_M_lmer_Colinet_sum.txt")
capture.output(anova(DW_M_lmer_Colinet),file = "DryWeight/DW_M_lmer_Colinet.txt")
capture.output(emmeans(DW_M_lmer_Colinet, list(pairwise ~ Population), adjust = "tukey"),file = "DryWeight/DW_M_lmer_Colinet_tk.txt")
DW_F_lmer_Hoedjes <- lmer(DW_micrograms ~ -1 + Population + (1|Population:Line) + (1|Batch), data = d_DW_F[d_DW_F$Supervisor.PI == "Hoedjes",])
capture.output(summary(DW_F_lmer_Hoedjes),file = "DryWeight/DW_F_lmer_Hoedjes_sum.txt")
capture.output(anova(DW_F_lmer_Hoedjes),file = "DryWeight/DW_F_lmer_Hoedjes.txt")
capture.output(emmeans(DW_F_lmer_Hoedjes, list(pairwise ~ Population), adjust = "tukey"),file = "DryWeight/DW_F_lmer_Hoedjes_tk.txt")
DW_M_lmer_Hoedjes <- lmer(DW_micrograms ~ -1 + Population + (1|Population:Line) + (1|Batch), data = d_DW_M[d_DW_M$Supervisor.PI == "Hoedjes",])
capture.output(summary(DW_M_lmer_Hoedjes),file = "DryWeight/DW_M_lmer_Hoedjes_sum.txt")
capture.output(anova(DW_M_lmer_Hoedjes),file = "DryWeight/DW_M_lmer_Hoedjes.txt")
capture.output(emmeans(DW_M_lmer_Hoedjes, list(pairwise ~ Population), adjust = "tukey"),file = "DryWeight/DW_M_lmer_Hoedjes_tk.txt")
DW_F_lmer_Onder <- lmer(DW_micrograms ~ -1 + Population + (1|Population:Line) + (1|Batch), data = d_DW_F[d_DW_F$Supervisor.PI == "Onder",])
capture.output(summary(DW_F_lmer_Onder),file = "DryWeight/DW_F_lmer_Onder_sum.txt")
capture.output(anova(DW_F_lmer_Onder),file = "DryWeight/DW_F_lmer_Onder.txt")
capture.output(emmeans(DW_F_lmer_Onder, list(pairwise ~ Population), adjust = "tukey"),file = "DryWeight/DW_F_lmer_Onder_tk.txt")
DW_M_lmer_Onder <- lmer(DW_micrograms ~ -1 + Population + (1|Population:Line) + (1|Batch), data = d_DW_M[d_DW_M$Supervisor.PI == "Onder",])
capture.output(summary(DW_M_lmer_Onder),file = "DryWeight/DW_M_lmer_Onder_sum.txt")
capture.output(anova(DW_M_lmer_Onder),file = "DryWeight/DW_M_lmer_Onder.txt")
capture.output(emmeans(DW_M_lmer_Onder, list(pairwise ~ Population), adjust = "tukey"),file = "DryWeight/DW_M_lmer_Onder_tk.txt")
DW_fitted <- combineFitted(labs = rep(c("Colinet", "Onder", "Hoedjes"), 2), sex = rep(c("F", "M"), each = 3), models = list(DW_F_lmer_Colinet, DW_F_lmer_Hoedjes, DW_F_lmer_Onder, DW_M_lmer_Colinet, DW_M_lmer_Hoedjes, DW_M_lmer_Onder))
p_DW_F_lab_cor <- function() scatterPlotMatrix(DW_fitted, sex = "F")
p_DW_M_lab_cor <- function() scatterPlotMatrix(DW_fitted, sex = "M")
p_DW_F_lab_cor()
pdf(file="DevelopmentTime/p_DW_F_lab_cor.pdf",width=8, height=8)
p_DW_F_lab_cor()
invisible(dev.off())
setwd("/Users/durmazm/Documents/GitHub/DrosEU_PhenotypingWG/")
pdf(file="DevelopmentTime/p_DW_F_lab_cor.pdf",width=8, height=8)
p_DW_F_lab_cor()
invisible(dev.off())
p_DW_M_lab_cor()
for (i in dev.list()[1]:dev.list()[length(dev.list())]) {
dev.off()
}
pdf(file="DevelopmentTime/p_DW_M_lab_cor.pdf",width=8, height=8)
p_DW_M_lab_cor()
invisible(dev.off())
d_TL <- read.csv("MasterSheets_Oct21_git/TL_MasterSheet_Oct21.csv")
str(d_TL)
str(d_TL)
d_TL$Supervisor.PI <- as.factor(d_TL$Supervisor.PI)
d_TL$Diet <- as.factor(d_TL$Diet)
d_TL$Batch <- as.factor(d_TL$Batch)
d_TL$Population_Lat <- factor(d_TL$Population, levels= c("YE","RE","GI","MU","MA","UM","KA","VA","AK"))
d_TL$Population_Lon <- factor(d_TL$Population, levels= c("RE","GI","KA","MU","MA","AK","UM","YE","VA"))
d_TL$Population_Alt <- factor(d_TL$Population, levels= c("KA","AK","GI","RE","UM","VA","MU","MA","YE"))
d_TL$Line <- as.factor(d_TL$Line)
d_TL$Sex <- as.factor(d_TL$Sex)
d_TL$ReplicateVial <- as.factor(d_TL$ReplicateVial)
d_TL$TL_micrometers <- as.numeric(d_TL$TL_micrometers)
str(d_TL)
d_TL_F <-subset(d_TL,Sex=='F')
d_TL_M <-subset(d_TL,Sex=='M')
####
TL_F_lmer_Kozeretska <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch) + (1|ReplicateVial : Line : Population), data = (subset(d_TL_F,Supervisor.PI=='Kozeretska')))
capture.output(summary(TL_F_lmer_Kozeretska),file = "ThoraxLength/TL_F_Kozeretska_sum.txt")
capture.output(anova(TL_F_lmer_Kozeretska),file = "ThoraxLength/TL_F_lmer_Kozeretska.txt")
capture.output(emmeans(TL_F_lmer_Kozeretska, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_tk.txt")
TL_M_lmer_Kozeretska <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch) + (1|ReplicateVial : Line : Population), data = (subset(d_TL_M,Supervisor.PI=='Kozeretska')))
capture.output(summary(TL_M_lmer_Kozeretska),file = "ThoraxLength/TL_M_Kozeretska_sum.txt")
capture.output(anova(TL_M_lmer_Kozeretska),file = "ThoraxLength/TL_M_lmer_Kozeretska.txt")
capture.output(emmeans(TL_M_lmer_Kozeretska, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_tk.txt")
TL_M_lmer_Posnien <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population), data = (subset(d_TL_M,Supervisor.PI=='Posnien')))
capture.output(summary(TL_M_lmer_Posnien),file = "ThoraxLength/TL_M_Posnien_sum.txt")
capture.output(anova(TL_M_lmer_Posnien),file = "ThoraxLength/TL_M_lmer_Posnien.txt")
capture.output(emmeans(TL_M_lmer_Posnien, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_lmer_Posnien_tk.txt")
p_TL_F_Posnien <- ggplot(data = (subset(d_TL_F,Supervisor.PI=='Posnien')), aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Posnien", x="Population", y = "TL_micrometers") + coord_cartesian(ylim = c(min_TL, max_TL))+ droseu_theme
p_TL_M_Posnien <- ggplot(data = (subset(d_TL_M,Supervisor.PI=='Posnien')), aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_M_Posnien", x="Population", y = "TL_micrometers")+ coord_cartesian(ylim = c(min_TL, max_TL))+ droseu_theme
TL_M_lmer_Posnien <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population), data = (subset(d_TL_M,Supervisor.PI=='Posnien')))
capture.output(summary(TL_M_lmer_Posnien),file = "ThoraxLength/TL_M_Posnien_sum.txt")
capture.output(anova(TL_M_lmer_Posnien),file = "ThoraxLength/TL_M_lmer_Posnien.txt")
capture.output(emmeans(TL_M_lmer_Posnien, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_lmer_Posnien_tk.txt")
TL_F_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_F,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_Ritchie_sum.txt")
capture.output(anova(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_lmer_Ritchie.txt")
capture.output(emmeans(TL_F_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Ritchie_tk.txt")
summary(TL_F_lmer_Ritchie)
TL_M_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_M,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_Ritchie_sum.txt")
capture.output(anova(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_lmer_Ritchie.txt")
capture.output(emmeans(TL_M_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_lmer_Ritchie_tk.txt")
TL_F_lmer_Schmidt <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population), data = (subset(d_TL_F,Supervisor.PI=='Schmidt')))
capture.output(summary(TL_F_lmer_Schmidt),file = "ThoraxLength/TL_F_Schmidt_sum.txt")
capture.output(anova(TL_F_lmer_Schmidt),file = "ThoraxLength/TL_F_lmer_Schmidt.txt")
capture.output(emmeans(TL_F_lmer_Schmidt, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Schmidt_tk.txt")
TL_fitted <- combineFitted(labs = rep(c("Kozeretska", "Posnien", "Ritchie"), 2), sex = rep(c("F", "M"), each = 3), models = list(TL_F_lmer_Kozeretska, TL_F_lmer_Posnien, TL_F_lmer_Ritchie, TL_M_lmer_Kozeretska, TL_M_lmer_Posnien, TL_M_lmer_Ritchie)) %>%
bind_rows(combineFitted(labs = "Schmidt", sex = "F", models = list(TL_F_lmer_Schmidt)))
TL_F_lmer_Posnien <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population)+
(1|ReplicateVial : Line : Population), data = (subset(d_TL_F,Supervisor.PI=='Posnien')))
capture.output(summary(TL_F_lmer_Posnien),file = "ThoraxLength/TL_F_Posnien_sum.txt")
capture.output(anova(TL_F_lmer_Posnien),file = "ThoraxLength/TL_F_lmer_Posnien.txt")
capture.output(emmeans(TL_F_lmer_Posnien, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Posnientk.txt")
TL_M_lmer_Posnien <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population), data = (subset(d_TL_M,Supervisor.PI=='Posnien')))
capture.output(summary(TL_M_lmer_Posnien),file = "ThoraxLength/TL_M_Posnien_sum.txt")
capture.output(anova(TL_M_lmer_Posnien),file = "ThoraxLength/TL_M_lmer_Posnien.txt")
capture.output(emmeans(TL_M_lmer_Posnien, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_lmer_Posnien_tk.txt")
TL_fitted <- combineFitted(labs = rep(c("Kozeretska", "Posnien", "Ritchie"), 2), sex = rep(c("F", "M"), each = 3), models = list(TL_F_lmer_Kozeretska, TL_F_lmer_Posnien, TL_F_lmer_Ritchie, TL_M_lmer_Kozeretska, TL_M_lmer_Posnien, TL_M_lmer_Ritchie)) %>%
bind_rows(combineFitted(labs = "Schmidt", sex = "F", models = list(TL_F_lmer_Schmidt)))
p_TL_F_lab_cor <- function() scatterPlotMatrix(TL_fitted, sex = "F")
p_TL_M_lab_cor <- function() scatterPlotMatrix(TL_fitted, sex = "M")
p_TL_F_lab_cor()
pdf(file="DevelopmentTime/p_TL_F_lab_cor.pdf",width=8, height=8)
p_TL_F_lab_cor()
invisible(dev.off())
p_TL_M_lab_cor()
p_TL_M_lab_cor()
pdf(file="DevelopmentTime/p_TL_M_lab_cor.pdf",width=8, height=8)
p_TL_M_lab_cor()
invisible(dev.off())
TL_fitted
p_TL_F_Ritchie <- ggplot(data = (subset(d_TL_F,Supervisor.PI=='Ritchie')), aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") + coord_cartesian(ylim =  c(min_TL, max_TL))+ droseu_theme
min_TL <- min(d_TL$TL_micrometers)
max_TL <- max(d_TL$TL_micrometers)
p_TL_F_Ritchie <- ggplot(data = (subset(d_TL_F,Supervisor.PI=='Ritchie')), aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") + coord_cartesian(ylim =  c(min_TL, max_TL))+ droseu_theme
p_TL_F_Ritchie
head(d_TL)
filter(d_TL_M, Supervisor.PI == "Ritchie", TL_micrometers > 10000)
filter(d_TL_M, Supervisor.PI == "Ritchie", Population == "AK") %>% ggplot(aes(x= Population_Lat, y= TL_micrometers, fill = Batch)
)
filter(d_TL_M, Supervisor.PI == "Ritchie", Population == "AK")
filter(d_TL_M, Supervisor.PI == "Ritchie", Population == "AK") %>% ggplot(aes(x= Population_Lat, y= TL_micrometers, fill = Batch))
filter(d_TL_F, Supervisor.PI == "Ritchie", Population == "AK") %>% ggplot(aes(x= Population_Lat, y= TL_micrometers, fill = Batch))
filter(d_TL_F, Supervisor.PI == "Schmidt", Population == "AK") %>% ggplot(aes(x= Population_Lat, y= TL_micrometers, fill = Batch))
filter(d_TL_F, Supervisor.PI == "Schmidt", Population == "AK") %>%
ggplot(aes(x= Population_Lat, y= TL_micrometers, fill = Batch))
filter(d_TL_M, Supervisor.PI == "Schmidt") %>%
ggplot(aes(x = Population_Lat, y= TL_micrometers, fill = Batch))
filter(d_TL_M, Supervisor.PI == "Schmidt") %>%
ggplot(aes(x = Population_Lat, y= TL_micrometers, fill = Batch)) +
eom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05)
filter(d_TL_M, Supervisor.PI == "Schmidt") %>%
ggplot(aes(x = Population_Lat, y= TL_micrometers, fill = Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05)
filter(d_TL_M, Supervisor.PI == "Ritchie") %>%
ggplot(aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") +
coord_cartesian(ylim = c(min_TL, max_TL)) +
droseu_theme
p_TL_F_Ritchie
p_TL_F_Posnien <- ggplot(data = (subset(d_TL_F,Supervisor.PI=='Posnien')), aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Posnien", x="Population", y = "TL_micrometers") + coord_cartesian(ylim = c(min_TL, max_TL))+ droseu_theme
p_TL_F_Posnien
p_TL_F_Ritchie <- ggplot(data = (subset(d_TL_F,Supervisor.PI=='Ritchie')), aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") + coord_cartesian(ylim =  c(min_TL, max_TL))+ droseu_theme
p_TL_F_Ritchie
filter(d_TL_F, Supervisor.PI == "Ritchie") %>%
ggplot(aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") +
coord_cartesian(ylim = c(min_TL, max_TL)) +
droseu_theme
filter(d_TL_F, Supervisor.PI == "Ritchie") %>% arrange(desc(TL_micrometers))
d_TL_F$TL_micrometers[ReplicateVial == "Ritchie_12_AK4_2" &  Individual == 2]
d_TL_F$TL_micrometers[d_TL_F$ReplicateVial == "Ritchie_12_AK4_2" &  d_TL_F$Individual == 2]
d_TL_F$TL_micrometers[d_TL_F$ReplicateVial == "Ritchie_12_AK4_2" &  d_TL_F$Individual == 2] <- 975
d_TL_F$TL_micrometers[d_TL_F$ReplicateVial == "Ritchie_12_AK4_2" &  d_TL_F$Individual == 2] <- 975
d_TL_F <-subset(d_TL,Sex=='F')
d_TL_M <-subset(d_TL,Sex=='M')
####
d_TL_F$TL_micrometers[d_TL_F$ReplicateVial == "Ritchie_12_AK4_2" &  d_TL_F$Individual == 2] <- 975 # quick fix - not corrected in this MasterSheet but corrected on Drive. One would need to replace the .csv file with the latest one.
d_TL_F <-subset(d_TL,Sex=='F')
d_TL_M <-subset(d_TL,Sex=='M')
####
WA_F_R_Ritchie_lmer <- lmer(CentroidSizeRight_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch) + (1|ReplicateVial : Line : Population), data = (subset(d_WA_F,Supervisor.PI=='Ritchie')))
TL_F_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_F,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_Ritchie_sum.txt")
capture.output(anova(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_lmer_Ritchie.txt")
capture.output(emmeans(TL_F_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Ritchie_tk.txt")
TL_M_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_M,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_Ritchie_sum.txt")
capture.output(anova(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_lmer_Ritchie.txt")
capture.output(emmeans(TL_M_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_lmer_Ritchie_tk.txt")
TL_fitted <- combineFitted(labs = rep(c("Kozeretska", "Posnien", "Ritchie"), 2), sex = rep(c("F", "M"), each = 3), models = list(TL_F_lmer_Kozeretska, TL_F_lmer_Posnien, TL_F_lmer_Ritchie, TL_M_lmer_Kozeretska, TL_M_lmer_Posnien, TL_M_lmer_Ritchie)) %>%
bind_rows(combineFitted(labs = "Schmidt", sex = "F", models = list(TL_F_lmer_Schmidt)))
p_TL_F_lab_cor <- function() scatterPlotMatrix(TL_fitted, sex = "F")
p_TL_M_lab_cor <- function() scatterPlotMatrix(TL_fitted, sex = "M")
p_TL_F_lab_cor()
summary(TL_F_lmer_Ritchie)
TL_F_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_F,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_Ritchie_sum.txt")
capture.output(anova(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_lmer_Ritchie.txt")
capture.output(emmeans(TL_F_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Ritchie_tk.txt")
filter(d_TL_F, Supervisor.PI == "Ritchie") %>%
ggplot(aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") +
coord_cartesian(ylim = c(min_TL, max_TL)) +
droseu_theme
d_TL <- read.csv("MasterSheets_Oct21_git/TL_MasterSheet_Oct21.csv")
str(d_TL)
str(d_TL)
str(d_TL)
d_TL$Supervisor.PI <- as.factor(d_TL$Supervisor.PI)
d_TL$Diet <- as.factor(d_TL$Diet)
d_TL$Batch <- as.factor(d_TL$Batch)
d_TL$Population_Lat <- factor(d_TL$Population, levels= c("YE","RE","GI","MU","MA","UM","KA","VA","AK"))
d_TL$Population_Lon <- factor(d_TL$Population, levels= c("RE","GI","KA","MU","MA","AK","UM","YE","VA"))
d_TL$Population_Alt <- factor(d_TL$Population, levels= c("KA","AK","GI","RE","UM","VA","MU","MA","YE"))
d_TL$Line <- as.factor(d_TL$Line)
d_TL$Sex <- as.factor(d_TL$Sex)
d_TL$ReplicateVial <- as.factor(d_TL$ReplicateVial)
d_TL$TL_micrometers <- as.numeric(d_TL$TL_micrometers)
str(d_TL)
d_TL$TL_micrometers[d_TL_F$ReplicateVial == "Ritchie_12_AK4_2" &  d_TL_F$Individual == 2] <- 975 # quick fix - not corrected in this MasterSheet but corrected on Drive. One would need to replace the .csv file with the latest one.
d_TL_F <-subset(d_TL,Sex=='F')
d_TL_M <-subset(d_TL,Sex=='M')
####
TL_F_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_F,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_Ritchie_sum.txt")
capture.output(anova(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_lmer_Ritchie.txt")
capture.output(emmeans(TL_F_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Ritchie_tk.txt")
summary(TL_F_lmer_Ritchie)
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2" &  d_TL$Individual == 2] <- 975 # quick fix - not corrected in this MasterSheet but corrected on Drive. One would need to replace the .csv file with the latest one.
d_TL_F <-subset(d_TL,Sex=='F')
d_TL_M <-subset(d_TL,Sex=='M')
####
TL_F_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_F,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_Ritchie_sum.txt")
capture.output(anova(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_lmer_Ritchie.txt")
capture.output(emmeans(TL_F_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Ritchie_tk.txt")
summary(TL_F_lmer_Ritchie)
TL_M_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_M,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_Ritchie_sum.txt")
capture.output(anova(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_lmer_Ritchie.txt")
capture.output(emmeans(TL_M_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_lmer_Ritchie_tk.txt")
filter(d_TL_F, Supervisor.PI == "Ritchie") %>%
ggplot(aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") +
coord_cartesian(ylim = c(min_TL, max_TL)) +
droseu_theme
p_TL_F_Ritchie
d_TL <- read.csv("MasterSheets_Oct21_git/TL_MasterSheet_Oct21.csv")
str(d_TL)
str(d_TL)
d_TL$Supervisor.PI <- as.factor(d_TL$Supervisor.PI)
d_TL$Diet <- as.factor(d_TL$Diet)
d_TL$Batch <- as.factor(d_TL$Batch)
d_TL$Population_Lat <- factor(d_TL$Population, levels= c("YE","RE","GI","MU","MA","UM","KA","VA","AK"))
d_TL$Population_Lon <- factor(d_TL$Population, levels= c("RE","GI","KA","MU","MA","AK","UM","YE","VA"))
d_TL$Population_Alt <- factor(d_TL$Population, levels= c("KA","AK","GI","RE","UM","VA","MU","MA","YE"))
d_TL$Line <- as.factor(d_TL$Line)
d_TL$Sex <- as.factor(d_TL$Sex)
d_TL$ReplicateVial <- as.factor(d_TL$ReplicateVial)
d_TL$TL_micrometers <- as.numeric(d_TL$TL_micrometers)
str(d_TL)
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2" &  d_TL$Individual == 2]
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2"]
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2" & d_TL$Individual == 2]
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2" & d_TL$Individual == 2 & sex == "F"]
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2" & d_TL$Individual == 2 & Sex == "F"]
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2" & d_TL$Individual == 2 & d_TL$Sex == "F"]
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2" & d_TL$Individual == 2 & d_TL$Sex == "F"] <- 975 # quick fix - not corrected in this MasterSheet but corrected on Drive. One would need to replace the .csv file with the latest one.
d_TL_F <-subset(d_TL,Sex=='F')
d_TL_M <-subset(d_TL,Sex=='M')
####
TL_F_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_F,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_Ritchie_sum.txt")
capture.output(anova(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_lmer_Ritchie.txt")
capture.output(emmeans(TL_F_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Ritchie_tk.txt")
summary(TL_F_lmer_Ritchie)
TL_M_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_M,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_Ritchie_sum.txt")
capture.output(anova(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_lmer_Ritchie.txt")
capture.output(emmeans(TL_M_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_lmer_Ritchie_tk.txt")
filter(d_TL_F, Supervisor.PI == "Ritchie") %>%
ggplot(aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") +
coord_cartesian(ylim = c(min_TL, max_TL)) +
droseu_theme
filter(d_TL_F, Population == "AK") %>% arrange(desc(TL_micrometers))
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_2_AK1_1" & d_TL$Individual == 9 & d_TL$Sex == "F"]
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_12_AK4_2" & d_TL$Individual == 2 & d_TL$Sex == "F"] <- 975 # quick fix - not corrected in this MasterSheet but corrected on Drive. One would need to replace the .csv file with the latest one.
d_TL$TL_micrometers[d_TL$ReplicateVial == "Ritchie_2_AK1_1" & d_TL$Individual == 9 & d_TL$Sex == "F"] <- 978 # quick fix - not corrected in this MasterSheet but corrected on Drive. One would need to replace the .csv file with the latest one.
d_TL_F <-subset(d_TL,Sex=='F')
d_TL_M <-subset(d_TL,Sex=='M')
####
TL_F_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_F,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_Ritchie_sum.txt")
capture.output(anova(TL_F_lmer_Ritchie),file = "ThoraxLength/TL_F_lmer_Ritchie.txt")
capture.output(emmeans(TL_F_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_F_lmer_Ritchie_tk.txt")
summary(TL_F_lmer_Ritchie)
TL_M_lmer_Ritchie <- lmer(TL_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch), data = (subset(d_TL_M,Supervisor.PI=='Ritchie')))
capture.output(summary(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_Ritchie_sum.txt")
capture.output(anova(TL_M_lmer_Ritchie),file = "ThoraxLength/TL_M_lmer_Ritchie.txt")
capture.output(emmeans(TL_M_lmer_Ritchie, list(pairwise ~ Population), adjust = "tukey"),file = "ThoraxLength/TL_M_lmer_Ritchie_tk.txt")
filter(d_TL_F, Supervisor.PI == "Ritchie") %>%
ggplot(aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") +
coord_cartesian(ylim = c(min_TL, max_TL)) +
droseu_theme
p_TL_F_Ritchie <- filter(d_TL_F, Supervisor.PI == "Ritchie") %>%
ggplot(aes(x=Population_Lat, y=TL_micrometers, fill=Batch)) +
geom_boxplot(outlier.shape = NA, notch=FALSE) +
geom_jitter(width=0.2,alpha=0.05) +
labs(title="p_TL_F_Ritchie", x="Population", y = "TL_micrometers") +
coord_cartesian(ylim = c(min_TL, max_TL)) +
droseu_theme
p_TL_F_Ritchie
pdf(file="ThoraxLength/p_TL_F_Ritchie.pdf",width=8, height=5)
p_TL_F_Ritchie
dev.off()
TL_fitted <- combineFitted(labs = rep(c("Kozeretska", "Posnien", "Ritchie"), 2), sex = rep(c("F", "M"), each = 3), models = list(TL_F_lmer_Kozeretska, TL_F_lmer_Posnien, TL_F_lmer_Ritchie, TL_M_lmer_Kozeretska, TL_M_lmer_Posnien, TL_M_lmer_Ritchie)) %>%
bind_rows(combineFitted(labs = "Schmidt", sex = "F", models = list(TL_F_lmer_Schmidt)))
p_TL_F_lab_cor <- function() scatterPlotMatrix(TL_fitted, sex = "F")
p_TL_M_lab_cor <- function() scatterPlotMatrix(TL_fitted, sex = "M")
p_TL_F_lab_cor()
pdf(file="DevelopmentTime/p_TL_F_lab_cor.pdf",width=8, height=8)
p_TL_F_lab_cor()
invisible(dev.off())
p_TL_M_lab_cor()
pdf(file="DevelopmentTime/p_TL_M_lab_cor.pdf",width=8, height=8)
p_TL_M_lab_cor()
invisible(dev.off())
pdf(file="ThoraxLength/p_TL_F_lab_cor.pdf",width=8, height=8)
p_TL_F_lab_cor()
invisible(dev.off())
pdf(file="ThoraxLength/p_TL_M_lab_cor.pdf",width=8, height=8)
p_TL_M_lab_cor()
invisible(dev.off())
pdf(file="DryWeight/p_DW_M_lab_cor.pdf",width=8, height=8)
p_DW_M_lab_cor()
invisible(dev.off())
pdf(file="DryWeight/p_DW_F_lab_cor.pdf",width=8, height=8)
p_DW_F_lab_cor()
invisible(dev.off())
d_WA <- read.csv("MasterSheets_Oct21_git/WA_MasterSheet_Nov21.csv")
str(d_WA)
d_WA$Supervisor.PI <- as.factor(d_WA$Supervisor.PI)
d_WA$Diet <- as.factor(d_WA$Diet)
d_WA$Batch <- as.factor(d_WA$Batch)
d_WA$Population_Lat <- factor(d_WA$Population, levels= c("YE","RE","GI","MU","MA","UM","KA","VA","AK"))
d_WA$Population_Lon <- factor(d_WA$Population, levels= c("RE","GI","KA","MU","MA","AK","UM","YE","VA"))
d_WA$Population_Alt <- factor(d_WA$Population, levels= c("KA","AK","GI","RE","UM","VA","MU","MA","YE"))
d_WA$Line <- as.factor(d_WA$Line)
d_WA$Sex <- as.factor(d_WA$Sex)
d_WA$ReplicateVial <- as.factor(d_WA$ReplicateVial)
d_WA$CentroidSizeLeft_micrometers <- as.numeric(d_WA$CentroidSizeLeft_micrometers)
d_WA$CentroidSizeRight_micrometers <- as.numeric(d_WA$CentroidSizeRight_micrometers)
str(d_WA)
d_WA_F <-subset(d_WA,Sex=='F')
d_WA_M <-subset(d_WA,Sex=='M')
WA_F_L_Onder_lmer <- lmer(CentroidSizeLeft_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch) + (1|ReplicateVial : Line : Population), data = (subset(d_WA_F,Supervisor.PI=='Onder')))
d_WA_F
WA_F_L_Onder_lmer <- lmer(CentroidSizeLeft_micrometers ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial:Line:Population), data = (subset(d_WA_F,Supervisor.PI=='Onder')))
WA_F_L_Onder_lmer <- lmer(CentroidSizeLeft_micrometers ~ -1 + Population + (1|Line:Population) + (1|Batch) + (1|ReplicateVial:Line:Population), data = d_WA_F %>% filter(Supervisor.PI=='Onder'))
class(d_WA_F)
WA_M_L_Onder_lmer <- lmer(CentroidSizeLeft_micrometers ~ -1 + Population + (1|Line:Population) +
(1|Batch) + (1|ReplicateVial : Line : Population), data = (subset(d_WA_M,Supervisor.PI=='Onder')))
