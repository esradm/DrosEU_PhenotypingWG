---
title: "**DrosEU Phenotyping Working Group Updates **"
author: "by Esra Durmaz Mitchell"
date: "Last updated: `r format(Sys.Date())`"
output: 
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    theme: yeti  
---


# Phenotyping effort 

General information  
How many labs  
How many people  


## Groningen 2017

- Fly husbandry @ IGC

- Phenotypes

- Decision to be made 

## Samples

- Locations

- Sampling 


```{r cars}

#Add samples map here, with people's names 

```


- Shipment to IGC

- Establishing lines @ IGC


## Phenotyping Call

- A few criteria for phenotyping 

- re : email to Elio about immunity 

- Responders

- Distribution of traits 

- Shipment of flies

- Phenotyping starts 

```{r}

#Add contributors map here 

```


# Phenotyping experiments 

## Overview 

List of traits in groups (JVieira's classification)

## Life-histroy traits 

### Viability

Sonja Grath (S), Marina Stamenkovic-Radak (S), Katja Hoedjes (NS), Patricia Gibert (NS)

### Developmental time

Sonja Grath (S), Marina Stamenkovic-Radak (S), Katja Hoedjes (NS), Patricia Gibert (NS)

### Fecundity

Eran Tauber (S), Claudia Fricke (S), Jean-Christophe Billeter (NS) 

### Lifespan

Thomas Flatt (S), Elena Pasyukova (S), Amanda Glaser-Schmitt (NS), Eliza Argyridou (NS)

## Size realated traits

### Dry weight 

Hervé Colinet (S), Eran Tauber (S), Banu Sebnem Onder (NS), Katja Hoedjes (NS)

### Wing area

Nico Posnien (S), Nicola Cook (S), Jean-Christophe Billeter (NS), Banu Sebnem Onder (NS)

### Thorax length

Nicola Cook (S), Nico Posnien (S), Iryna Kozeretska (NS), Patrícia Beldade (NS) 


## Temperature related traits

### Chill-coma recovery time

Jorge Vieira (S), Elvira Lafuente (NS), Patricia Gibert (NS)

### Cold-shock mortality

Jorge Vieira (S), Pepi Gonzalez (S), Elvira Lafuente (NS), Iryna Kozeretska (NS) 

### Diapause

Thomas Flatt (S), Alan Bergland (S), Élio (NS) Manolis Lirakis (NS)

### Heat-shock mortality

Jorge Vieira (S), Joyce Kao (S), Amanda Glaser-Schmitt (NS), Eliza Argyridou (NS)


## Other traits 

### Starvation resistance

Elena Pasyukova (S), Pepi Gonzalez (S), Banu Sebnem Onder (NS)

### Pigmentation

Alan Bergland (S), Jessica Abbott (S), Patrícia Beldade (NS), Patricia Gibert (NS)

### Locomotor activity

Eran Tauber (S), Jessica Abbott (S)


# Methods

## Phenotyping 
Contributors and their experimental methods

### Viability
##### Gibert, Grath, Hoedjes, Schmidt, Stamenkovic-Radak and Zwaan Labs

_Contributors : Patricia Gibert, Sonja Grath, Paul Schmidt, Marina Stamenkovic-Radak, Bas Zwann, Joost van den Heuvel, Vieira Cristina, Mouton Laurence, Kremer Natacha, Martinez Sonia, Ingo Müller, Hristina Kostic, Amy Goldfischer, Paul Schmidt, Ozan Kiratli, Yonatan Babore, Liam Forsythe, Marija Savic Veselinovic, Marija Tanaskovic, Aleksandra Patenkovic, Mihailo Jelic, Katarina Eric, Pavle Eric, Slobodan Davidovic_


3-5 day old adults (at least 25 pairs) are allowed to lay eggs en masse. Yeast is provided to stimulate egg laying (for at least 2 hours). Eggs are collected, and 40 are placed in each vial. Viability is calculated per vial, as the percentage of individuals that emerged from the 40 eggs.

Please see below number of 

_Add methods for Schmidt Lab_
_Replicate vials_  

### Developmental time

#### Egg-to-pupa developmental time
##### Schmidt Lab
Paul Schmidt, .... 


#### Egg-to-adult developmental time
##### Gibert, Grath, Hoedjes, Schmidt, Stamenkovic-Radak and Zwaan Labs
Patricia Gibert, Katja Hoedjes, Paul Schmidt, Marina Stamenkovic-Radak, Bas Zwann, .... 
Developmental time is scored as both the egg-to-pupa and egg-to-adult development time. Both were scored twice a day, when the chamber lights are turned on and two hours before they are turned off. In order to measure the egg-to-pupa developmental time, the spot where a pupa is found is marked with a permanent marker to keep track of which pupae have emerged in each day. The egg-to-adult developmental time is estimated by counting all emerged adults from the vial, and by sexing them.


### Dry weight
##### Colinet, Hoedjes and Onder Labs
Herve Colinet, Katja Hoedjes, Banu Onder, .... 


At day 7 after emergence, flies are killed by snap freezing them in liquid nitrogen, by putting them at -20ºC or by putting them into an ethyl acetate solution and stored at -20ºC. Then they are sexed and placed into 96 wells plates, and placed in an oven set at 60-70 °C, for at least 3 days. At this point flies can be stored at room temperature using a protective cover. If this is the case, the day before measurements are made dry flies are again placed for 24h in the oven (60-70 °C) to ensure material is well dehydrated. Flies are then placed on a small piece of aluminium foil for direct weight measurement on microbalance (accuracy 1µg).


### Thorax length
##### Kozeretska, Posnien, Ritchie and Schmidt Labs

Five to seven days old flies are placed onto a double-sided sticky tape attached to a microscope slide and a picture of the thorax taken using a digital camera connected to a dissecting microscope. The same magnification and resolution is always used to increase reproducibility, and a scale bar inserted on each photo to allow transforming pixels into µm units. Thorax length is defined as the distance from the anterior margin of the thorax to the posterior tip of the scutellum and it is measured using the “Straight Line” in ImageJ/Fiji.


### Wing area
##### Onder, Posnien, Ritchie and Stamenkovic-Radak Labs

Both the left and right wings of five to seven days old flies (10 flies per sex per replicate) are removed and placed into a drop of Entellan®Merck, Hoyer’s Medium, sticked to a double-side sticky tape, or taped directly to the slide. Pictures of the wing preparations are taken using a digital camera connected to a dissecting microscope. The same magnification and resolution is always used to increase reproducibility. A scale bar is placed on each photo to allow transforming pixels into µm units. Manual measurements of wing length and wing area are performed using the “Straight Line” and “Polygon Selection” tools, respectively of ImageJ/Fiji (10.1371/journal.pone.0000007).


### Fecundity
##### Billeter and Fricke Labs

For each isofemale line, 10 males and 10 females are placed together in single-sex groups and allowed to mature for five days. Then, they are placed together (5-7 pairs), and mating interactions observed to ensure successful mating (at least 10 min copulation duration) to ensure that we have five successfully mated females. After a successful mating, males are discarded and females allowed to oviposit alone for 48 hours, moved to another vial, and allowed to oviposit for four days, and again moved to another vial and allowed to oviposit for two days to check that of egg-laying stopped. Vials are incubated until all offspring is born. Individuals are then frozen and the offspring counted.


### Lifespan
##### Flatt, Parsch and Pasyukova Labs
Esra Durmaz, Envel Kerdaffrec, TBO, Virginie, John Parsch, Amanda, Eliza, Lena Pasyukova, Alexander 

Line level lifespan: Ten flies per sex/line are placed in each vial. The age at death will be scored when changing the food, at least three times a week. Five replicates are used.

Population level lifespan: Flies are kept in 1L demography cages (5 flies per line/sex for each population). The age at death will be scored when changing the food, at least three times a week. Ten replicates were performed.


### Cold-shock mortality
##### Gonzalez, Kozeretska and Vieira Labs

Batches of 15-20 seven days old flies are placed for 18 hours in an empty vial immersed in an ice-water slurry box placed at a 4°C room for 18 hours. Then the vials are removed to a bench in a 25°C room and mortality scored 24 hours later.


### Chill-coma recovery time
##### Vieira and Mensh Labs

Sexed flies are placed in an empty vial immersed in an ice-water slurry box placed at a 4°C room in the morning. Six hours later, flies are removed from the tube to individual wells of 24 well plates while being kept on ice. A timer is started once the plate is moved from the ice to a bench in a 25°C room. Each fly is checked by eye for recovery for a maximum of 60 minutes. Flies that are able to stand on their legs are considered recovered and the CCRT (in seconds) recorded.


### Heat-shock mortality
##### Parsch and Vieira Labs

Batches of 15-20 seven days old flies are placed in empty vials inside a 37ºC incubator and mortality checked for 7 hours every 30 minutes.


### Diapause
##### Bergland, Flatt and Schlotterer Labs

In order to induce diapause, two hour old 'phenotypic virgins' (pharate or melanized with meconium visible) female flies are exposed to 12°C and 10:14 light/dark hours for 3 weeks, using an incubator that allows temperature tracking. Vials are changed once per week. After three weeks under diapause conditions, flies are frozen at -80C until dissection. Both ovaries will be examined and classified according to the following simplified 'classification': 1) < stage 10: diapause; 2) stage 10-13: intermediate; 3) stage 14: non-diapause.


- Standard diapause conditions: 12°C at 10:14 hrs L:D (under these conditions we might expect around 50% dipause frequency)
- duration of exposure: 3 weeks
- assays will be done in incubators (Percival or Memmert); temperature conditions will be tracked using data loggers / iButtons
- Try to have haphazard standardization; similar conditions coupled with consistent tracking of temperature (multiple iButtons, for example)
- We will use egg lays in bottles to be able to collect more flies for the assay (approx. 1-2 bottles per line)
- Larval density will be controlled (approximately) prior to assays: we will do this by letting a fixed number of (approx. 10-20) females (housed together with 5-10 males) oviposit over night (fixed time window) - how many females and the duration of egg laying might need to be adjusted a bit depending on the fertility of the lines (to be determined when lines are being amplified prior to assays)
- The Bergland and Flatt labs will standardize their fly food according to the Gulbenkian recipe (in terms of amounts / proportions); Manolis from the Schlötterer lab will not standardize the food and use their local diet; importantly, flies for the assays will not be exposed to any (additional) live yeast (i.e., the diet will contain liophilized yeast but no live yeast sprinkled on top).
- From the bottles we will collect upon eclosion 'phenotypic virgins' (=pharate adults or melanized with meconium visible), approx. within 2 hours after eclosion
- Flies will be kept in vials for assay (15-20 flies in the same vial to account for mortality); we aim to measure a minimum of 10 females per line (from approx. 10-15 lines x 10 populations, yielding about 1000-1500 flies for dissections in total)
- The food in the assays will be changed once per week
- To keep the workload and effort manageable the assays will be performed in 2-3 blocks (optimally only 2) over time: e.g., from each population we will measure a subset of all lines (e.g., 5-7 lines, i.e. 1/2 or 1/3 of all lines) in each of the 2-3 blocks. 
- After 3 weeks under diapause conditions, flies will either be dissected or kept frozen until dissection (dry, at -80C; can be stored for a few months) 
- We will adopt a simplified diapause 'classification':
- Stage 10 will be defined as the checkpoint
- < Stage 10: diapause
- Stage 10-13: intermediate
- Stage 14: non-diapause
- We will examine both ovaries.


### Circadian eclosion timing
##### Wegener Lab

### Locomotor activity
##### Tauber Lab

The locomotor activity of the flies (males only) was measured using the DAM2 Drosophila monitors (Trikinetics Inc., Waltham, MA). Flies were 1-3 days old. Single flies were placed in glass tubes (10 cm × 0.5 cm) that were filled with 2 cm sugar/agar medium. The monitors were placed in light chambers driven by LED,  in an incubator at 24°C, ~30% humidity. The flies were entrained to a light-dark cycle (LD 12:12) for 5d and then allowed to free-run for 10 d in constant darkness (DD). The activity data were processed into 30 min bins, and four different variables were analysed. These included the circadian period, and the phase, which were analyzed using the FFT NLLS algorithm available at the BioDare2 server (https://biodare2.ed.ac.uk/). The other two variables, level of activity and the nocturnal/diurnal ratio were analyzed by a custom-made R script.
 

### Starvation resistance
##### Gonzalez, Onder and Pasyukova Labs

Batches of 10 sexed flies are transferred to glass vials filled with 5 mL of 2% agar for starvation 3-7 days after eclosion. The age at death will be scored every 8 hours.

### Pigmentation
##### Abbott, Gibert and Schmidt

For each line, 10 females, 13-15 days old, either alive or stored in 95% ethanol, are air dried and placed on their left side, and pictures taken using a dissecting microscope. Images are then analysed in ImageJ 1.46r, using the Area Fraction measurement in the Analyze menu. Area Fraction measures the percentage of pixels in a selected area that have been highlighted in red using the Threshold tool. This gives an estimate of the percentage of dark pigmentation on the three terminal tergites of the abdomen (4, 5 and 6). 

## Data reformatting 

MasterSheets 

_Insert a MasterSheet example_


### Data check

For each trait, sex and lab, we run counts for population, line and replicate vial (if applicable).


# Results I : Linear Models 


```{r, echo=FALSE}
localgit <- "/Users/durmazm/Documents/GitHub/DrosEU_PhenotypingWG/"

```

```{r}
setwd(localgit)
```

```{r echo=TRUE, message=FALSE}

library(ggplot2)
library(dplyr)
library(plyr)
library(tibble)
library(ggpubr)
library(multcompView)
library(hrbrthemes)
library(tidyverse)
library(rworldmap)
library(maps)
#library(rnaturalearth)
library(maptools)
library(rgeos)
library(qwraps2)
library(afex)
library(Hmisc)
library(lme4)
library(nlme)
library(multcomp)
library(emmeans)
library(coxme)
library(ggpubr)
library(knitr)
```


## Viability

Contributors: Gibert, Grath, Hoedjes, Schmidt, Stamenkovic-Radak and Zwaan Labs

### Data reformatting
_Insert lists_

**Read data in R**
```{r}
d_Via <- read.csv("MasterSheets_Oct21_git/VIA_MasterSheet_Oct21.csv")
str(d_Via)
```

Factors need reformatting (i.e. Supervisor.PI should be coded as a factor, not character).

```{r}
str(d_Via)
d_Via$Supervisor.PI <- as.factor(d_Via$Supervisor.PI)
d_Via$Diet <- as.factor(d_Via$Diet)
d_Via$Batch <- as.factor(d_Via$Batch)
d_Via$Population_Lat <- factor(d_Via$Population, levels= c("YE","RE","GI","MU","MA","UM","KA","VA","AK"))
d_Via$Population_Lon <- factor(d_Via$Population, levels= c("RE","GI","KA","MU","MA","AK","UM","YE","VA"))
d_Via$Population_Alt <- factor(d_Via$Population, levels= c("KA","AK","GI","RE","UM","VA","MU","MA","YE"))
d_Via$Line <- as.factor(d_Via$Line)
d_Via$ReplicateVial <- as.factor(d_Via$ReplicateVial)
d_Via$ProportionEggtoAdultSurvival <- as.numeric(d_Via$ProportionEggtoAdultSurvival)
d_Via$Country <- as.factor(d_Via$Country)
d_Via$Latitude <- as.numeric(d_Via$Latitude)
d_Via$Longitude <- as.numeric(d_Via$Longitude)
d_Via$Altitude <- as.numeric(d_Via$Altitude)
```

Now they should be in the correct format, see below. 
```{r}
str(d_Via)
```


### Descriptive Statistics

Define standard error and coefficient of variation : 

```{r, echo=TRUE}
std_err <- function(x) sd(x)/sqrt(length(x))
coef_var <- function(x) sd(x)/mean(x)
estimate_mode <- function(v) {
   uniqv <- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
}
```

Tables for descriptive statistics at population and line level : 
```{r}
table_Via_Line <- write.csv(d_Via %>% group_by(Supervisor.PI, Batch, Population, Line) %>% summarise_at(vars(ProportionEggtoAdultSurvival), list(Mean = mean, SD= sd, Median = median, Min = min, Max = max, SE = std_err, CV = coef_var, Mode = estimate_mode)), file = "table_Via_Line.csv", row.names = T)
```

```{r}
table_Via_Line
```


```{r}
table_Via_Pop <- write.csv(d_Via %>% group_by(Supervisor.PI, Batch, Population) %>% summarise_at(vars(ProportionEggtoAdultSurvival), list(Mean = mean, SD= sd, Median = median, Min = min, Max = max, SE = std_err, CV = coef_var, Mode = estimate_mode)), file = "table_Via_Pop.csv", row.names = T)
```


```{r}
table_Via_Pop
```


### Plots and Linear Models by Lab

**ggplot theme:**  
```{r}
droseu_theme <- theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black",),  axis.title.x = element_text(size = 16), axis.text.x = element_text(size = 16),axis.text.y = element_text(size = 16),axis.title.y = element_text(size = 16))

```

Data range is calculated with min and max functions :

```{r, echo=TRUE}
min_Via <- min(d_Via$ProportionEggtoAdultSurvival)
max_Via <- max(d_Via$ProportionEggtoAdultSurvival)
```


y-axis is scaled by the minimum (`r min_Via`) and maximum (`r max_Via`) values in the full data set. 

Here is an example code for egg-to-adult viability, Schmidt Lab. The same code is used to generate plots for other contributing labs by filtering the data at supervisor level (for females and males, if applicable). 

#### Schmidt Lab
```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_Schmidt.pdf",width=8, height=5)
p_Via_Schmidt <- ggplot(data = (subset(d_Via,Supervisor.PI=='Schmidt')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Batch)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_Schmidt", x="Population", y = "ProportionEggtoAdultSurvival")
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_Schmidt + coord_cartesian(ylim = c(min_Via, max_Via))+ droseu_theme
invisible(dev.off())
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_pop_Schmidt.pdf",width=8, height=5)
p_Via_pop_Schmidt <- ggplot(data = (subset(d_Via,Supervisor.PI=='Schmidt')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Population)) +geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_pop_Schmidt", x="Population", y = "ProportionEggtoAdultSurvival") 
dev.off()
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_pop_Schmidt + coord_cartesian(ylim = c(min_Via, max_Via))+ droseu_theme
invisible(dev.off())
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
Via_lmer_Schmidt <- lm(ProportionEggtoAdultSurvival ~ Population, data = d_Via[d_Via$Supervisor.PI == "Schmidt",])
capture.output(summary(Via_lmer_Schmidt),file = "Via_lmer_Schmidt_sum.txt")
capture.output(anova(Via_lmer_Schmidt),file = "Via_lmer_Schmidt.txt")
capture.output(emmeans(Via_lmer_Schmidt, list(pairwise ~ Population), adjust = "tukey"),file = "Via_lmer_Schmidt_tk.txt")
```

```{r}
anova(Via_lmer_Schmidt)
```

```{r}
summary(Via_lmer_Schmidt)
```

#### Stamenkovic-Radak Lab

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_StamenkovicRadak.pdf",width=8, height=5)
p_Via_StamenkovicRadak <- ggplot(data = (subset(d_Via,Supervisor.PI=='StamenkovicRadak')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Batch)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_StamenkovicRadak", x="Population", y = "ProportionEggtoAdultSurvival")
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_StamenkovicRadak + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_pop_StamenkovicRadak.pdf",width=8, height=5)
p_Via_pop_StamenkovicRadak <- ggplot(data = (subset(d_Via,Supervisor.PI=='StamenkovicRadak')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Population)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_pop_StamenkovicRadak", x="Population", y = "ProportionEggtoAdultSurvival") 
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_pop_StamenkovicRadak + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
Via_lmer_StamenkovicRadak <- lmer(ProportionEggtoAdultSurvival ~ Population + (1|Line:Population)+ (1|Batch), data = d_Via[d_Via$Supervisor.PI == "StamenkovicRadak",])
capture.output(summary(Via_lmer_StamenkovicRadak),file = "Via_lmer_StamenkovicRadak_sum.txt")
capture.output(anova(Via_lmer_StamenkovicRadak),file = "Via_lmer_StamenkovicRadak.txt")
capture.output(emmeans(Via_lmer_StamenkovicRadak, list(pairwise ~ Population), adjust = "tukey"),file = "Via_lmer_StamenkovicRadak_tk.txt")
```

```{r}
anova(Via_lmer_StamenkovicRadak)
```

```{r}
summary(Via_lmer_StamenkovicRadak)
```


#### Zwaan Lab

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_Zwaan.pdf",width=8, height=5)
p_Via_Zwaan <- ggplot(data = (subset(d_Via,Supervisor.PI=='Zwaan')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Batch)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_Zwaan", x="Population", y = "ProportionEggtoAdultSurvival")
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_Zwaan + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_pop_Zwaan.pdf",width=8, height=5)
p_Via_pop_Zwaan <- ggplot(data = (subset(d_Via,Supervisor.PI=='Zwaan')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Population)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_pop_Zwaan", x="Population", y = "ProportionEggtoAdultSurvival") 
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_pop_Zwaan + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}

Via_lmer_Zwaan <- lmer(ProportionEggtoAdultSurvival ~ Population + (1|Line:Population) + (1|Batch), data = d_Via[d_Via$Supervisor.PI == "Zwaan",])
capture.output(summary(Via_lmer_Zwaan),file = "Via_lmer_Zwaan_sum.txt")
capture.output(anova(Via_lmer_Zwaan),file = "Via_lmer_Zwaan.txt")
capture.output(emmeans(Via_lmer_Zwaan, list(pairwise ~ Population), adjust = "tukey"),file = "Via_lmer_Zwaan_tk.txt")
```

```{r}
anova(Via_lmer_Zwaan)
```

```{r}
summary(Via_lmer_Zwaan)
```

#### Hoedjes Lab

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_Hoedjes.pdf",width=8, height=5)
p_Via_Hoedjes <- ggplot(data = (subset(d_Via,Supervisor.PI=='Hoedjes')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Batch)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_Hoedjes", x="Population", y = "ProportionEggtoAdultSurvival")
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_Hoedjes + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_pop_Hoedjes.pdf",width=8, height=5)
p_Via_pop_Hoedjes <- ggplot(data = (subset(d_Via,Supervisor.PI=='Hoedjes')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Population)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_pop_Hoedjes", x="Population", y = "ProportionEggtoAdultSurvival") 
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_pop_Hoedjes + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
Via_lmer_Hoedjes <- lmer(ProportionEggtoAdultSurvival ~ Population + (1|Line:Population) + (1|Batch), data = d_Via[d_Via$Supervisor.PI == "Hoedjes",])
capture.output(summary(Via_lmer_Hoedjes),file = "Via_lmer_Hoedjes_sum.txt")
capture.output(anova(Via_lmer_Hoedjes),file = "Via_lmer_Hoedjes.txt")
capture.output(emmeans(Via_lmer_Hoedjes, list(pairwise ~ Population), adjust = "tukey"),file = "Via_lmer_Hoedjes_tk.txt")
```

```{r}
anova(Via_lmer_Hoedjes)
```

```{r}
summary(Via_lmer_Hoedjes)
```


#### Grath Lab

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_Grath.pdf",width=8, height=5)
p_Via_Grath <- ggplot(data = (subset(d_Via,Supervisor.PI=='Grath')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Batch)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_Grath", x="Population", y = "ProportionEggtoAdultSurvival")
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_Grath + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_pop_Grath.pdf",width=8, height=5)
p_Via_pop_Grath <- ggplot(data = (subset(d_Via,Supervisor.PI=='Grath')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Population)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_pop_Grath", x="Population", y = "ProportionEggtoAdultSurvival") 
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_pop_Grath + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
Via_lmer_Grath <- lmer(ProportionEggtoAdultSurvival ~ Population + (1|Line:Population) , data = d_Via[d_Via$Supervisor.PI == "Grath",])
capture.output(summary(Via_lmer_Grath),file = "Via_lmer_Grath_sum.txt")
capture.output(anova(Via_lmer_Grath),file = "Via_lmer_Grath.txt")
capture.output(emmeans(Via_lmer_Grath, list(pairwise ~ Population), adjust = "tukey"),file = "Via_lmer_Grath_tk.txt")
```

```{r}
anova(Via_lmer_Grath)
```


```{r}
summary(Via_lmer_Grath)
```

#### Gibert Lab

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_Gibert.pdf",width=8, height=5)
p_Via_Gibert <- ggplot(data = (subset(d_Via,Supervisor.PI=='Gibert')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Batch)) + geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_Gibert", x="Population", y = "ProportionEggtoAdultSurvival")
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_Gibert + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
pdf(file="p_Via_pop_Gibert.pdf",width=8, height=5)
p_Via_pop_Gibert <- ggplot(data = (subset(d_Via,Supervisor.PI=='Gibert')), aes(x=Population_Lat, y=ProportionEggtoAdultSurvival, fill=Population)) +geom_boxplot(outlier.shape = NA, notch=FALSE) +  geom_jitter(width=0.2,alpha=0.05) + labs(title="p_Via_pop_Gibert", x="Population", y = "ProportionEggtoAdultSurvival") 
```

```{r, echo=FALSE, message= FALSE, warning=FALSE}
p_Via_pop_Gibert + coord_cartesian(ylim = c(0, 1))+ droseu_theme
invisible(dev.off())
```


```{r, echo=FALSE, message= FALSE, warning=FALSE}
Via_lmer_Gibert <- lmer(ProportionEggtoAdultSurvival ~ Population + (1|Line:Population) + (1|Batch) , data = d_Via[d_Via$Supervisor.PI == "Gibert",])
capture.output(summary(Via_lmer_Gibert),file = "Via_lmer_Gibert_sum.txt")
capture.output(anova(Via_lmer_Gibert),file = "Via_lmer_Gibert.txt")
capture.output(emmeans(Via_lmer_Gibert, list(pairwise ~ Population), adjust = "tukey"),file = "Via_lmer_Gibert_tk.txt")
```

```{r}
anova(Via_lmer_Gibert)
```

```{r}
summary(Via_lmer_Gibert)
```



### Lab correlations

## Developmental time

### Egg-to-pupa developmental time

#### Data Reformatting
#### Descriptive Statistics
#### Plots and Linear Models by Lab

##### Schmidt Lab

### Egg-to-adult developmental time

#### Data Reformatting
#### Descriptive Statistics
#### Plots and Linear Models by Lab

##### Gibert Lab
##### Grath Lab
##### Hoedjes Lab
##### Schmidt Lab
##### Stamenkovic-Radak Lab
##### Zwaan Lab

#### Lab correlations

## Dry weight

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Colinet Lab
#### Hoedjes Lab 
#### Onder Lab

### Lab correlations

## Thorax length

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Kozeretska Lab
#### Posnien Lab 
#### Ritchie Lab
#### Schmidt Lab

### Lab correlations

## Wing area - Right

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Onder Lab
#### Posnien Lab 
#### Ritchie Lab
#### Stamenkovic-Radak Lab

### Lab correlations

## Wing area - Left

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Onder Lab
#### Posnien Lab 
#### Ritchie Lab
#### Stamenkovic-Radak Lab

### Lab correlations

## Fecundity

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Billeter Lab
#### Fricke Lab 

### Lab correlations

## Lifespan

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Flatt Lab
#### Parsch Lab 
#### Pasyukova Lab

### Survival Analyses

#### Flatt Lab
#### Parsch Lab 
#### Pasyukova Lab

### Lab correlations

## Cold-shock mortality

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Gonzalez Lab
#### Kozeretska Lab 
#### Vieira Lab

### Lab correlations

## Chill-coma recovery time

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Vieira Lab
#### Mensh Lab 

### Lab correlations

## Heat-shock mortality

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Parsch Lab
#### Vieira Lab 

### Lab correlations

## Diapause

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Bergland Lab
#### Flatt Lab 
#### Schlotterer Lab

### Lab correlations

## Circadian eclosion timing

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Wegener Lab

_Meeting w Eran and Chris_ 

- Eran to make circular figures for both CET and LA
- no sexual dimorphism for period. YAY! 
- auto detection of _phase_ is not reliable in the software - Eran wants to drop that trait in his data. 
- Watson Ftest
- Circular data ANOVA : there are R packages 
- more cold adapted was expected to eclose later (to wait for the warmer period of the day) but it is not the case
- LD : log2 transformation
- Activity : any transformation
- Period : ?transformation
- Eran's L:D -> D:D (circ)
- Chris sent littoralis paper - can use our diapause results to compare! 

## Locomotor activity

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Tauber Lab

Eran to make circular figures for both CET and LA

## Starvation resistance

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Gonzalez Lab
#### Onder Lab 
#### Pasyukova Lab

### Survival Analyses

#### Gonzalez Lab
#### Onder Lab 
#### Pasyukova Lab

### Lab correlations

## Pigmentation

### Data Reformatting
### Descriptive Statistics
### Plots and Linear Models by Lab

#### Abbott Lab

Data will be available by mid-January.

#### Gibert Lab 
#### Schmidt Lab

### Lab correlations


# Results II : Meta-Analyses

## with Diet 
## with Wolbachia

# Results III : Trait Correlations

## Stress related traits
## Temperature related traits
## Size related traits

# Results III : Qst - Fst 

# Results IV : Environmental Variables 

# Results V : Heritability